Логику кода диктовал я, а вот набирал его другой человек прям на паре.
Не бейте меня за кривизну, це не я та й хата не моя!!!